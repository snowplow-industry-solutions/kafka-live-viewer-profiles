s-backend  | 2024-11-25T04:55:55.969Z DEBUG 1 --- [ntainer#0-0-C-1] c.s.l.service.KafkaConsumerService       : Status for viewer 0c69ef56-a1b0-4f3a-b9d0-8b73f503cc5c is now WATCHING_VIDEO
s-backend  | 2024-11-25T04:55:55.982Z DEBUG 1 --- [ntainer#0-0-C-1] c.s.l.r.VideoEventRepositoryImpl         : THE FOLLOWING DEBUG INFORMATION MUST BE REMOVED!
s-backend  | 2024-11-25T04:55:55.982Z DEBUG 1 --- [ntainer#0-0-C-1] c.s.l.r.VideoEventRepositoryImpl         : spring.cloud.aws.credentials.access-key=admin
s-backend  | 2024-11-25T04:55:55.982Z DEBUG 1 --- [ntainer#0-0-C-1] c.s.l.r.VideoEventRepositoryImpl         : spring.cloud.aws.credentials.secret-key=admin
s-backend  | 2024-11-25T04:55:55.982Z DEBUG 1 --- [ntainer#0-0-C-1] c.s.l.r.VideoEventRepositoryImpl         : spring.cloud.aws.dynamodb.region=eu-west-2
s-backend  | 2024-11-25T04:55:56.130Z ERROR 1 --- [ntainer#0-0-C-1] c.s.l.service.KafkaConsumerService       : Error processing message: {"collector_tstamp":"2024-11-25T04:55:49.658Z","event_id":"d44faa36-54a1-4c84-ba11-1b0f803fbc3a","event_name":"play_event","viewer_id":"0c69ef56-a1b0-4f3a-b9d0-8b73f503cc5c","adsClicked":0,"adsSkipped":3,"adId":0,"video_ts":0}
s-backend  |
s-backend  | software.amazon.awssdk.services.dynamodb.model.ResourceNotFoundException: Cannot do operations on a non-existent table (Service: DynamoDb, Status Code: 400, Request ID: 78110e3e-aae5-4596-bd85-415b57d36338)
s-backend  |    at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handleErrorResponse(CombinedResponseHandler.java:125) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handleResponse(CombinedResponseHandler.java:82) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handle(CombinedResponseHandler.java:60) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handle(CombinedResponseHandler.java:41) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:50) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:38) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:72) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:42) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:78) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:40) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:55) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:39) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:81) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:36) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:56) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:36) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.executeWithTimer(ApiCallTimeoutTrackingStage.java:80) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:60) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:42) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:50) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:32) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:37) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:26) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.http.AmazonSyncHttpClient$RequestExecutionBuilderImpl.execute(AmazonSyncHttpClient.java:224) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.invoke(BaseSyncClientHandler.java:103) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.doExecute(BaseSyncClientHandler.java:173) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.lambda$execute$1(BaseSyncClientHandler.java:80) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.measureApiCallSuccess(BaseSyncClientHandler.java:182) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.execute(BaseSyncClientHandler.java:74) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.core.client.handler.SdkSyncClientHandler.execute(SdkSyncClientHandler.java:45) ~[sdk-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.awscore.client.handler.AwsSyncClientHandler.execute(AwsSyncClientHandler.java:53) ~[aws-core-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.services.dynamodb.DefaultDynamoDbClient.putItem(DefaultDynamoDbClient.java:4043) ~[dynamodb-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.enhanced.dynamodb.internal.operations.CommonOperation.execute(CommonOperation.java:114) ~[dynamodb-enhanced-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.enhanced.dynamodb.internal.operations.TableOperation.executeOnPrimaryIndex(TableOperation.java:59) ~[dynamodb-enhanced-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.enhanced.dynamodb.internal.client.DefaultDynamoDbTable.putItem(DefaultDynamoDbTable.java:268) ~[dynamodb-enhanced-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.enhanced.dynamodb.internal.client.DefaultDynamoDbTable.putItem(DefaultDynamoDbTable.java:276) ~[dynamodb-enhanced-2.21.46.jar!/:na]
s-backend  |    at software.amazon.awssdk.enhanced.dynamodb.internal.client.DefaultDynamoDbTable.putItem(DefaultDynamoDbTable.java:281) ~[dynamodb-enhanced-2.21.46.jar!/:na]
s-backend  |    at io.awspring.cloud.dynamodb.DynamoDbTemplate.save(DynamoDbTemplate.java:60) ~[spring-cloud-aws-dynamodb-3.1.1.jar!/:3.1.1]
s-backend  |    at com.snowplowanalytics.liveviewerprofile.repository.VideoEventRepositoryImpl.saveVideoEvent(VideoEventRepositoryImpl.java:47) ~[!/:0.0.1-SNAPSHOT]
s-backend  |    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
s-backend  |    at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
s-backend  |    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.14.jar!/:6.1.14]
s-backend  |    at com.snowplowanalytics.liveviewerprofile.repository.VideoEventRepositoryImpl$$SpringCGLIB$$0.saveVideoEvent(<generated>) ~[!/:0.0.1-SNAPSHOT]
s-backend  |    at com.snowplowanalytics.liveviewerprofile.service.KafkaConsumerService.listen(KafkaConsumerService.java:59) ~[!/:0.0.1-SNAPSHOT]
s-backend  |    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
s-backend  |    at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
s-backend  |    at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-6.1.14.jar!/:6.1.14]
s-backend  |    at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at io.micrometer.observation.Observation.observe(Observation.java:565) ~[micrometer-observation-1.13.6.jar!/:1.13.6]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296) ~[spring-kafka-3.2.4.jar!/:3.2.4]
s-backend  |    at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804) ~[na:na]
s-backend  |    at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
